{var $css = "excursion"}
{var $js = "excursion"}
{var $pageTitle = $trip->title . ' V√Ωlety Dominik√°nsk√° republika'}
{var $pageDescription = ($trip->description ?: ('V√Ωlety Dominik√°nsk√° republika: ' . $trip->title)) }
{var $ogImage = $basePath . '/img/' . $trip->img_folder . '/' . $trip->img_name}

{block content}

    <div class="trip-hero" style="background-image: url('{$basePath}/img/{$trip->img_folder}/{$trip->img_name}')">
        <div class="trip-hero__overlay">
            <div class="trip-hero__inner">
                <a n:href="Home:default" class="trip-hero__back">‚Üê Zpƒõt na v√Ωlety</a>
                <h1 class="trip-hero__title">{$trip->title}</h1>
                <p class="trip-hero__subtitle">{$trip->description}</p>
            </div>
        </div>
    </div>

    <section class="trip-main">
        <div class="trip-main__inner">

            <div class="trip-main__left">
                <section class="trip-section">
                    <h2>O v√Ωletu</h2>
                    <p class="trip-section__text">
                        {$trip->full_description|breaklines}
                    </p>
                </section>

                <section class="trip-section trip-section--columns">
                    <div class="trip-section__col">
                        <h2>Co je zahrnuto</h2>
                        <ul class="trip-list trip-list--included">
                            {foreach $included as $item}
                                {if trim($item) !== ''}
                                    <li>{$item}</li>
                                {/if}
                            {/foreach}
                        </ul>
                    </div>

                    <div class="trip-section__col">

                    </div>
                </section>
            </div>

            <aside class="trip-main__right">
                <div class="trip-price-card">
                    <div class="trip-price-card__price">
                    <span class="trip-price-card__amount">
                        od {$trip->price|number:0,',',' '} USD
                    </span>
                        <span class="trip-price-card__per">na osobu</span>
                    </div>

                    <div class="trip-price-card__meta">
                        <div class="trip-meta-item">
                            <span class="trip-meta-item__icon">‚è±</span>
                            <span>{$trip->duration}</span>
                        </div>
                        <div class="trip-meta-item">
                            <span class="trip-meta-item__icon">üë•</span>
                            <span>A≈æ {$trip->group_size} lid√≠</span>
                        </div>
                        <div class="trip-meta-item">
                            <span class="trip-meta-item__icon">üìç</span>
                            <span>{$trip->location}</span>
                        </div>
                    </div>

                    <a n:href="reservation! $trip->id" class="trip-price-card__button">
                        Rezervovat v√Ωlet
                    </a>

                    <div class="trip-price-card__note">
                        Bezplatn√© zru≈°en√≠ a≈æ 24 hodin p≈ôed zaƒç√°tkem
                    </div>
                </div>

                <div class="trip-help-card">
                    <h3>Pot≈ôebujete pomoc? Nen√≠ voln√Ω term√≠n?</h3>
                    <p>Kontaktujte n√°s pro v√≠ce informac√≠ nebo pro rezervaci.</p>
                    <a n:href="Home:default#kontakt" class="trip-help-card__button">
                        Kontaktovat n√°s
                    </a>
                </div>
            </aside>

        </div>
    </section>

    {if $showReservationModal}
        <div class="reservation-modal-backdrop">
            <div class="reservation-modal reservation-modal--wide">

                <div class="reservation-modal__header">
                    <h2>Rezervace: {$trip->title}</h2>
                    <a n:href="this" class="reservation-modal__close">√ó</a>
                </div>

                <div class="reservation-modal__body">
                    {if empty($allowedDates)}
                        <p style="margin: 0; text-align: center; color: #6b7280; font-size: 15px; line-height: 1.6;">
                            Moment√°lnƒõ nejsou k dispozici ≈æ√°dn√© term√≠ny pro tento v√Ωlet.<br>
                            Kontaktujte n√°s pro v√≠ce informac√≠, p≈ôes formul√°≈ô nebo WhatsApp.
                        </p>
                    {else}

                        <div class="reservation-modal__layout">

                            <div class="reservation-modal__formcol">
                                {form reservationForm}
                                    {input trip_id}
                                    {input token}

                                    <div class="reservation-form__group">
                                        <label for="frm-reservationForm-name">Jm√©no a p≈ô√≠jmen√≠ *</label>
                                        {input name}
                                    </div>

                                    <div class="reservation-form__group">
                                        <label for="frm-reservationForm-email">Email *</label>
                                        {input email}
                                    </div>

                                    <div class="reservation-form__group">
                                        <label for="frm-reservationForm-phone">Telefon</label>
                                        {input phone}
                                    </div>

                                    <div class="reservation-form__group">
                                        <label for="frm-reservationForm-date">Datum v√Ωletu *</label>
                                        <div class="reservation-form__date-wrapper">
                                            <span class="reservation-form__date-icon"></span>
                                            {input date, data-allowed-dates => $allowedDatesJson}
                                        </div>
                                    </div>

                                    <div class="reservation-form__group">
                                        <label for="frm-reservationForm-persons">Poƒçet osob *</label>
                                        {input persons}
                                    </div>

                                    <div class="reservation-form__group">
                                        <label>M√≠sto vyzvednut√≠ *</label>
                                        <div class="pickup-options">
                                            {foreach $form[pickup]->items as $key => $label}
                                                <label class="pickup-option">
                                                    {input pickup:$key}
                                                    <span class="pickup-option__text">{$label}</span>
                                                </label>
                                            {/foreach}
                                        </div>
                                    </div>

                                    <div class="reservation-form__group">
                                        <label for="frm-reservationForm-note">Pozn√°mka a p≈ôesn√° lokace vyzvednut√≠</label>
                                        {input note}
                                    </div>

                                    <button n:name="send" class="reservation-modal__submit">
                                        Odeslat rezervaci
                                    </button>
                                {/form}
                            </div>

                            <aside class="reservation-modal__summary">
                                <div class="res-summary__title">Souhrn ceny</div>

                                <div class="res-summary__line">
                                    <span>Cena za osobu</span>
                                    <strong><span data-price="pp">0</span> USD</strong>
                                </div>

                                <div class="res-summary__line">
                                    <span>Poƒçet osob</span>
                                    <strong><span data-price="persons">1</span></strong>
                                </div>

                                <div class="res-summary__divider"></div>

                                <div class="res-summary__total">
                                    <span>Celkem</span>
                                    <strong><span data-price="total">0</span> USD</strong>
                                </div>

                                <div class="res-summary__note">
                                    Koneƒçn√° cena m≈Ø≈æe b√Ωt up≈ôesnƒõna podle domluvy a dostupnosti.
                                </div>
                            </aside>

                        </div>

                        <script>
                            window.pickupPrices = {$pickupPricesJson|noescape};
                        </script>

                    {/if}
                </div>

            </div>
        </div>
    {/if}

{/block}
