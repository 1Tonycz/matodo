{var $css = 'home'}
{var $js = 'home'}
{block content}
<div class="admin-dashboard">

    <header class="admin-dashboard__header">
        <h1>Dashboard</h1>
    </header>

    <section class="admin-dashboard__stats">
        <div class="admin-card">
            <div class="admin-card__header">
                <span class="admin-card__title">Dotazy</span>
                <span class="admin-card__icon">üí¨</span>
            </div>
            <div class="admin-card__value">{$inquiriesCount}</div>
            <div class="admin-card__subtext">
                {$newInquiriesCount} nov√Ωch
            </div>
        </div>

        <div class="admin-card">
            <div class="admin-card__header">
                <span class="admin-card__title">V√Ωlety</span>
                <span class="admin-card__icon admin-card__icon--green">üó∫</span>
            </div>
            <div class="admin-card__value">{$tripsCount}</div>
            <div class="admin-card__subtext">
                v nab√≠dce
            </div>
        </div>

        <div class="admin-card">
            <div class="admin-card__header">
                <span class="admin-card__title">Rezervace</span>
                <span class="admin-card__icon admin-card__icon--orange">üìÖ</span>
            </div>
            <div class="admin-card__value">{$reservationsCount}</div>
            <div class="admin-card__subtext">
                {$pendingReservationsCount} ƒçek√° na potvrzen√≠
            </div>
        </div>

        <div class="admin-card">
            <div class="admin-card__header">
                <span class="admin-card__title">Zobrazen√≠ v√Ωlet≈Ø</span>
                <span class="admin-card__icon admin-card__icon--purple">üëÅ</span>
            </div>
            <div class="admin-card__value">{$viewsCount}</div>
            <div class="admin-card__subtext">
                celkem
            </div>
        </div>

        <div class="admin-card">
            <div class="admin-card__header">
                <span class="admin-card__title">Opu≈°tƒõn√© rezervace</span>
                <span class="admin-card__icon admin-card__icon--danger">‚ö†</span>
            </div>
            <div class="admin-card__value">{$abandonedPercent}%</div>
            <div class="admin-card__subtext">
                nedokonƒçen√Ωch
            </div>
        </div>
    </section>

    <section class="admin-dashboard__grid">
        <div class="admin-panel">
            <div class="admin-panel__header">
                <span class="admin-panel__title">
                    <span class="admin-panel__title-icon">üìä</span>
                    Rezervace podle mƒõsic≈Ø
                </span>
            </div>

            <div class="admin-panel__body admin-panel__body--chart">
                <canvas id="reservationsChart"
                        data-labels="{=json_encode(array_keys($reservationsByMonth))}"
                        data-values="{=json_encode(array_values($reservationsByMonth))}">
                </canvas>
            </div>
        </div>

        <div class="admin-panel">
            <div class="admin-panel__header">
                <span class="admin-panel__title">
                    <span class="admin-panel__title-icon">üìà</span>
                    Konverze: Zobrazen√≠ vs Rezervace
                </span>
            </div>

            <div class="admin-panel__body admin-panel__body--conversion">
                <div class="admin-conversion">
                    <div class="admin-conversion__item">
                        <div class="admin-conversion__icon admin-conversion__icon--blue">üëÅ</div>
                        <div class="admin-conversion__value">{$conversionViews}</div>
                        <div class="admin-conversion__label">Zobrazen√≠</div>
                    </div>

                    <div class="admin-conversion__item">
                        <div class="admin-conversion__icon admin-conversion__icon--green">üõí</div>
                        <div class="admin-conversion__value">{$conversionReservations}</div>
                        <div class="admin-conversion__label">Rezervace</div>
                    </div>
                </div>

                <div class="admin-conversion__divider"></div>

                <div class="admin-conversion__footer">
                    Konverzn√≠ pomƒõr: <strong>{$conversionRate}%</strong>
                </div>
            </div>
        </div>
    </section>
    <section class="admin-dashboard__grid-secondary">

        {* Top 3 nejprod√°vanƒõj≈°√≠ v√Ωlety *}
    <div class="admin-panel admin-panel--toplist admin-panel--toplist-green">
                <div class="admin-panel__header">
            <span class="admin-panel__title">
                <span class="admin-panel__title-icon">üìà</span>
                Top 3 nejprod√°vanƒõj≈°√≠ v√Ωlety
            </span>
                </div>

                <div class="admin-panel__body">
                    <div class="admin-toplist">
                        {if $topBestTrips}
                            {foreach $topBestTrips as $i => $trip}
                                <div class="admin-toplist__item">
                                    <div class="admin-toplist__rank">
                                        #{$i+1}
                                    </div>
                                    <div class="admin-toplist__content">
                                        <div class="admin-toplist__name">
                                            {$trip->name}
                                        </div>
                                        <div class="admin-toplist__meta">
                                            {$trip->reservations} rezervac√≠
                                        </div>
                                    </div>
                                </div>
                            {/foreach}
                        {else}
                            <p class="admin-toplist__empty">Zat√≠m ≈æ√°dn√© rezervace.</p>
                        {/if}
                    </div>
                </div>
    </div>

    {* Top 3 nejm√©nƒõ prod√°van√© v√Ωlety *}
    <div class="admin-panel admin-panel--toplist admin-panel--toplist-orange">
                <div class="admin-panel__header">
            <span class="admin-panel__title">
                <span class="admin-panel__title-icon">‚ö†</span>
                Top 3 nejm√©nƒõ prod√°van√© v√Ωlety
            </span>
                </div>

                <div class="admin-panel__body">
                    <div class="admin-toplist">
                        {if $topWorstTrips}
                            {foreach $topWorstTrips as $i => $trip}
                                <div class="admin-toplist__item">
                                    <div class="admin-toplist__rank">
                                        #{$i+1}
                                    </div>
                                    <div class="admin-toplist__content">
                                        <div class="admin-toplist__name">
                                            {$trip->name}
                                        </div>
                                        <div class="admin-toplist__meta">
                                            {$trip->reservations} rezervac√≠
                                        </div>
                                    </div>
                                </div>
                            {/foreach}
                        {else}
                            <p class="admin-toplist__empty">Zat√≠m ≈æ√°dn√° data.</p>
                        {/if}
                    </div>
                </div>
    </div>

    {* Nejnav≈°tƒõvovanƒõj≈°√≠ v√Ωlet *}
    <div class="admin-panel admin-panel--wide">
                <div class="admin-panel__header">
            <span class="admin-panel__title">
                <span class="admin-panel__title-icon">üëÅ</span>
                Nejnav≈°tƒõvovanƒõj≈°√≠ v√Ωlet
            </span>
                </div>

                <div class="admin-panel__body">
                    {if $mostVisitedTrip}
                        <div class="admin-mostviewed">
                            <div class="admin-mostviewed__name">
                                {$mostVisitedTrip->name}
                            </div>

                            <div class="admin-mostviewed__highlight">
                                <div class="admin-mostviewed__views">
                            <span class="admin-mostviewed__views-number">
                                {$mostVisitedTrip->views}
                            </span>
                                    <span class="admin-mostviewed__views-label">
                                zobrazen√≠
                            </span>
                                </div>
                                <div class="admin-mostviewed__extra">
                                    {$mostVisitedTrip->reservations} rezervac√≠
                                    ({$mostVisitedTrip->conversion}% konverze)
                                </div>
                            </div>
                        </div>
                    {else}
                        <p>Zat√≠m ≈æ√°dn√° zobrazen√≠.</p>
                    {/if}
                </div>
    </div>

    {* Hodnocen√≠ v√Ωlet≈Ø *}
        <div class="admin-panel admin-panel--wide">
            <div class="admin-panel__header">
            <span class="admin-panel__title">
                <span class="admin-panel__title-icon">‚≠ê</span>
                Hodnocen√≠ v√Ωlet≈Ø
            </span>
            </div>

            <div class="admin-panel__body">
                {if $ratingsSummary}
                    <p>Pr≈Ømƒõrn√© hodnocen√≠: <strong>{$ratingsSummary->avgRating|number:1}</strong>/5</p>
                    <p>Celkem {$ratingsSummary->count} hodnocen√≠.</p>
                {else}
                    <p>Zat√≠m ≈æ√°dn√° hodnocen√≠.</p>
                {/if}
            </div>
        </div>

    </section>
    <section class="admin-dashboard__profit">
        <div class="admin-panel admin-panel--table">
            <div class="admin-panel__header">
            <span class="admin-panel__title">
                <span class="admin-panel__title-icon">üí≤</span>
                Ziskovost v√Ωlet≈Ø
            </span>
            </div>

            <div class="admin-panel__body">
                <table class="admin-table admin-table--profit">
                    <thead>
                    <tr>
                        <th>V√Ωlet</th>
                        <th class="admin-table__th--right">Rezervace</th>
                        <th class="admin-table__th--right">Tr≈æby</th>
                        <th class="admin-table__th--right">N√°klady</th>
                        <th class="admin-table__th--right">Zisk</th>
                    </tr>
                    </thead>
                    <tbody>
                    {foreach $tripsProfit as $trip}
                        <tr>
                            <td>{$trip->name}</td>
                            <td class="admin-table__td--right">
                                {$trip->reservations}
                            </td>
                            <td class="admin-table__td--right">
                                {$trip->revenue|number:0}&nbsp;$
                            </td>
                            <td class="admin-table__td--right">
                                {$trip->costs|number:0}&nbsp;$
                            </td>
                            <td class="admin-table__td--right admin-table__profit
           {if $trip->profit < 0} is-negative {else} is-positive {/if}">
                                {$trip->profit|number:0}&nbsp;$
                            </td>
                        </tr>
                    {/foreach}
                    </tbody>
                </table>
            </div>
        </div>
    </section>

</div>
{/block}
